<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>متجر XIX</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet" />
<style>
:root {
  --accent: #007bff;
  --bg: #f6f8fb;
  --card: #fff;
  --overlay: rgba(0, 0, 0, 0.6);
}
* { box-sizing: border-box; font-family: 'Cairo', sans-serif; }
body { margin: 0; background: var(--bg); color: #222; }
header { background: var(--accent); color: #fff; padding: 18px; text-align: center; font-size: 20px; font-weight: bold; }
.nav-buttons { text-align: center; margin: 15px 0; }
.nav-buttons button {
  margin: 5px;
  padding: 10px 16px;
  border: none;
  border-radius: 8px;
  background: var(--accent);
  color: #fff;
  font-weight: bold;
  cursor: pointer;
}
.nav-buttons button.active { background: #0056b3; }
.container { max-width: 1100px; margin: auto; padding: 16px; }
.products { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 16px; }
.card { background: var(--card); border-radius: 12px; box-shadow: 0 6px 18px rgba(0, 0, 0, 0.06); padding: 12px; text-align: center; }
.card img { width: 100%; height: 150px; object-fit: contain; }
.price { color: var(--accent); font-weight: 700; margin: 8px 0; }
.btn { padding: 8px 12px; border: none; border-radius: 8px; background: var(--accent); color: #fff; cursor: pointer; }
.cart-icon { position: fixed; top: 20px; left: 20px; background: transparent; color: #000; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15); z-index: 10000; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 30px; user-select: none; transition: background-color 0.3s ease; }
.cart-icon:hover { background-color: #eee; }
#cartCount { background: #e74c3c; border-radius: 100%; padding: 2px 1px; font-size: 10px; position: absolute; top: 1px; left: 30px; min-width: 25px; text-align: center; font-weight: 900; color: #fff; user-select: none; }
.overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--overlay); justify-content: center; align-items: center; z-index: 9999; }
.popup { background: #fff; border-radius: 12px; padding: 20px; max-width: 400px; width: 90%; box-shadow: 0 6px 18px rgba(0, 0, 0, 0.3); text-align: center; position: relative; }
.popup h3 { margin-top: 0; }
.popup input { width: 100%; padding: 8px; margin: 10px 0 16px; border-radius: 8px; border: 1px solid #ccc; }
.qr-img { max-width: 150px; margin: 10px auto 16px; display: block; }
.checkmark { display: none; width: 80px; height: 80px; border-radius: 50%; align-items: center; justify-content: center; background: #4CAF50; margin: 20px auto; }
.checkmark svg { width: 50px; height: 50px; stroke: white; stroke-width: 4; fill: none; stroke-dasharray: 48; stroke-dashoffset: 48; animation: draw 1s forwards; }
@keyframes draw { to { stroke-dashoffset: 0; } }
.close-btn { position: absolute; top: 10px; left: 12px; background: #eee; border-radius: 50%; width: 28px; height: 28px; line-height: 28px; font-weight: bold; color: #444; cursor: pointer; border: none; }
#ordersListPopup .popup { background: #222; color: #eee; max-width: 500px; border-radius: 12px; padding: 20px; box-shadow: 0 8px 30px rgba(0,0,0,0.8); font-size: 15px; line-height: 1.5; text-align: right; direction: rtl; }
#ordersListPopup .popup h3 { color: #fff; margin-bottom: 15px; font-weight: 800; text-align: center; }
#ordersListPopup .orders-list { background: #333; border-radius: 10px; padding: 12px; max-height: 320px; overflow-y: auto; border: 1px solid #555; }
#ordersListPopup .orders-list p { border-bottom: 1px solid #444; padding: 8px 0; color: #ddd; }
#ordersListPopup .orders-list p strong { color: #f39c12; }
#ordersListPopup .close-btn { background: #555; color: #eee; font-weight: 900; font-size: 18px; border-radius: 50%; width: 32px; height: 32px; top: 12px; left: 12px; box-shadow: 0 0 10px #f39c12; transition: background-color 0.3s ease; }
#ordersListPopup .close-btn:hover { background: #f39c12; color: #222; }
.row { display: flex; gap: 10px; align-items: center; }
.row input { flex: 1; }
</style>
</head>
<body>
<header>متجر XIX</header>

<div class="nav-buttons">
  <button id="appsBtn" class="active" onclick="showCategory('apps')">شحن التطبيقات</button>
  <button id="balanceBtn" onclick="showCategory('balance')">شحن الرصيد</button>
</div>

<div class="container">
  <div class="products" id="products"></div>
</div>

<div class="cart-icon" id="cartIcon" title="عرض الطلبات المرسلة" onclick="showOrdersPopup()">
  🛒
  <span id="cartCount">0</span>
</div>

<div class="overlay" id="orderPopup">
  <div class="popup">
    <button class="close-btn" onclick="closeOrderPopup()">×</button>
    <h3 id="popupTitle">طلب المنتج</h3>
    <div id="stepContent"></div>
    <div class="checkmark" id="checkmark">
      <svg viewBox="0 0 52 52"><path d="M14 27 l7 7 l17 -17"></path></svg>
    </div>
  </div>
</div>

<div class="overlay" id="ordersListPopup" style="display:none;">
  <div class="popup">
    <button class="close-btn" onclick="closeOrdersPopup()">×</button>
    <h3>الطلبات المرسلة</h3>
    <div id="ordersList" class="orders-list">لا توجد طلبات حتى الآن.</div>
  </div>
</div>

<script>
const whatsappNumber = "+994401888888"; // ضع رقمك هنا
const emailAddress = "your-email@example.com"; // ضع بريدك هنا

const productsApps = [
 { id: 1, title: 'استرجاع شام كاش', price: 30.00, img: 'https://f.top4top.io/p_3512o1stv1.jpg' },
  { id: 2, title: 'طريقة استرجاع حسابات الشام', price: 100.00, img: 'https://f.top4top.io/p_3512o1stv1.jpg' },
  { id: 3, title: 'فك حظر تيك توك', price: 3.00, img: 'https://j.top4top.io/p_3512tjkcr1.jpg' },
  { id: 4, title: 'واتساب معدل', price: 3.00, img: 'https://l.top4top.io/p_3512bcblf1.jpg' },
  { id: 5, title: 'فك حضر واتساب', price: 5.00, img: 'https://j.top4top.io/p_3512i415e1.jpg' },
  { id: 6, title: 'استرجاع بريد الاكتروني', price: 20.00, img: 'https://c.top4top.io/p_3512g2d7j1.jpg' },
  { id: 7, title: 'استرجاع صور محذوفه', price: 51.99, img: 'https://a.top4top.io/p_3512p1gzm1.jpg' },
  { id: 8, title: 'طلب حل ايا مشكله', price: 0.99, img: 'https://f.top4top.io/p_35120u6bd1.jpg' }
];

const productsBalance = [
  { id: 101, title: 'شحن رصيد MTN', price: 1.00, img: 'https://via.placeholder.com/300x200?text=Pay+1+USD' },
  { id: 102, title: 'شحن رصيد SYRIATEL', price: 2.10, img: 'https://via.placeholder.com/300x200?text=Pay+1+USD' }
   
let currentCategory = 'apps';
let currentProduct = null;
let currentStep = 1;
let customerName = '';
let customerWhatsApp = '';
let customerNote = '';
let coinCount = 0;
let sentOrders = JSON.parse(localStorage.getItem('sentOrders')) || [];

function renderProducts() {
  const productsEl = document.getElementById('products');
  productsEl.innerHTML = '';
  const productsData = currentCategory === 'apps' ? productsApps : productsBalance;
  productsData.forEach(p => {
    const card = document.createElement('div');
    card.className = 'card';
    card.innerHTML = `
      <img src="${p.img}" alt="${p.title}" />
      <h4>${p.title}</h4>
      <div class="price">${p.price.toFixed(2)} USD</div>
      <button class="btn" onclick="startOrder(${p.id})">أضف للسلة</button>
    `;
    productsEl.appendChild(card);
  });
}

function showCategory(category) {
  currentCategory = category;
  document.getElementById('appsBtn').classList.remove('active');
  document.getElementById('balanceBtn').classList.remove('active');
  if (category === 'apps') document.getElementById('appsBtn').classList.add('active');
  else document.getElementById('balanceBtn').classList.add('active');
  renderProducts();
}

function startOrder(productId) {
  const productsData = currentCategory === 'apps' ? productsApps : productsBalance;
  currentProduct = productsData.find(p => p.id === productId);
  currentStep = 1;
  customerName = '';
  customerWhatsApp = '';
  customerNote = '';
  coinCount = 0;
  document.getElementById('checkmark').style.display = 'none';
  document.getElementById('stepContent').style.display = 'block';
  showStep();
  document.getElementById('orderPopup').style.display = 'flex';
}

function closeOrderPopup() { document.getElementById('orderPopup').style.display = 'none'; }

function showStep() {
  const title = document.getElementById('popupTitle');
  const content = document.getElementById('stepContent');

  if(currentCategory === 'balance'){
    if(currentStep === 1){
      title.textContent = "اختر عدد الكوينز";
      content.innerHTML = `
        <div class="row">
          <input id="coinCountInput" type="number" placeholder="عدد الكوينز" />
          <input id="coinPriceInput" type="text" placeholder="سعر الرصيد" disabled />
        </div>
        <button class="btn" onclick="nextStep()">التالي</button>
      `;
      document.getElementById('coinCountInput').addEventListener('input', function(){
        const val = parseInt(this.value) || 0;
        coinCount = val;
        const pricePer1000 = currentProduct.price;
        document.getElementById('coinPriceInput').value = ((val/1000)*pricePer1000).toFixed(2) + " USD";
      });
    } else if(currentStep === 2){
      title.textContent = "أدخل معلوماتك للشحن";
      content.innerHTML = `
        <input id="customerNameInput" placeholder="الاسم الثلاثي" />
        <input id="customerIdInput" placeholder="ID الحساب" />
        <input id="customerPhoneInput" placeholder="رقم الهاتف" />
        <button class="btn" onclick="nextStep()">التالي</button>
      `;
    } else if(currentStep === 3){
      title.textContent = "ادفع 1 دولار لبدء العملية";
      content.innerHTML = `
        <img src="https://via.placeholder.com/200x200?text=Pay+1+USD" class="qr-img" />
        <button class="btn" onclick="paymentDoneBalance()">تم الدفع</button>
      `;
    }
  } else {
    if(currentStep === 1){
      title.textContent = "أدخل الاسم الثلاثي";
      content.innerHTML = `<input id="customerNameInput" placeholder="الاسم الثلاثي" /><button class="btn" onclick="nextStep()">التالي</button>`;
    } else if(currentStep === 2){
      title.textContent = "رقم واتساب للتواصل";
      content.innerHTML = `<input id="customerWhatsAppInput" placeholder="رقم واتساب" /><button class="btn" onclick="nextStep()">التالي</button>`;
    } else if(currentStep === 3){
      title.textContent = "ملاحظة إضافية";
      content.innerHTML = `<input id="customerNoteInput" placeholder="ملاحظة (اختياري)" /><button class="btn" onclick="paymentDoneApp()">تم الدفع</button>`;
    }
  }
}

function nextStep() {
  if(currentCategory === 'balance'){
    if(currentStep === 1){
      const val = parseInt(document.getElementById('coinCountInput').value);
      if(!val || val<=0){ alert('أدخل عدد الكوينز'); return; }
      coinCount = val;
      currentStep++;
    } else if(currentStep === 2){
      customerName = document.getElementById('customerNameInput').value.trim();
      const customerId = document.getElementById('customerIdInput').value.trim();
      const customerPhone = document.getElementById('customerPhoneInput').value.trim();
      if(!customerName || !customerId || !customerPhone){ alert('أدخل جميع البيانات'); return; }
      customerWhatsApp = customerPhone; // للواتساب
      currentStep++;
    }
  } else {
    if(currentStep === 1){
      const val = document.getElementById('customerNameInput').value.trim();
      if(!val){ alert('أدخل الاسم'); return; }
      customerName = val;
      currentStep++;
    } else if(currentStep === 2){
      const val = document.getElementById('customerWhatsAppInput').value.trim();
      if(!val){ alert('أدخل رقم واتساب'); return; }
      customerWhatsApp = val;
      currentStep++;
    }
  }
  showStep();
}

function getOrderMessage() {
    return `✨ طلب جديد ✨
🛒 المنتج: ${currentProduct.title}
💵 السعر: ${currentCategory==='balance' ? ((coinCount/1000)*currentProduct.price).toFixed(2)+' USD' : currentProduct.price+' USD'}
📦 الكمية / الرصيد: ${currentCategory==='balance' ? coinCount+' كونز' : '-'}
👤 الاسم: ${customerName}
📱 واتساب: ${customerWhatsApp}
📝 ملاحظة: ${customerNote || '-'}
📅 تاريخ الطلب: ${new Date().toLocaleString()}`;
}

function sendOrder() {
    const message = getOrderMessage();
    const isMobile = /Mobi|Android/i.test(navigator.userAgent);

    if(isMobile){
        const url = `https://wa.me/${whatsappNumber.replace(/\+/g,'')}?text=${encodeURIComponent(message)}`;
        window.open(url, "_blank");
    } else {
        const subject = encodeURIComponent("طلب جديد من متجر XIX");
        const body = encodeURIComponent(message);
        window.open(`mailto:${emailAddress}?subject=${subject}&body=${body}`);
    }
}

function paymentDoneBalance() {
  document.getElementById('checkmark').style.display = 'flex';
  document.getElementById('stepContent').style.display = 'none';
  setTimeout(() => {
    sendOrder();
    sentOrders.push({product: currentProduct.title, price: ((coinCount/1000)*currentProduct.price).toFixed(2)+' USD', name: customerName, whatsapp: customerWhatsApp, note: customerNote || '-', date: new Date().toLocaleString()});
    localStorage.setItem('sentOrders', JSON.stringify(sentOrders));
    updateCartCount();
    document.getElementById('checkmark').style.display = 'none';
    closeOrderPopup();
  },2000);
}

function paymentDoneApp() {
  customerNote = document.getElementById('customerNoteInput').value.trim();
  document.getElementById('checkmark').style.display = 'flex';
  document.getElementById('stepContent').style.display = 'none';
  setTimeout(() => {
    sendOrder();
    sentOrders.push({product: currentProduct.title, price: currentProduct.price+' USD', name: customerName, whatsapp: customerWhatsApp, note: customerNote || '-', date: new Date().toLocaleString()});
    localStorage.setItem('sentOrders', JSON.stringify(sentOrders));
    updateCartCount();
    document.getElementById('checkmark').style.display = 'none';
    closeOrderPopup();
  },2000);
}

function updateCartCount() { document.getElementById('cartCount').textContent = sentOrders.length; }

function showOrdersPopup() {
  document.getElementById('ordersListPopup').style.display = 'flex';
  const ordersList = document.getElementById('ordersList');
  if(sentOrders.length === 0) ordersList.innerHTML = 'لا توجد طلبات حتى الآن.';
  else ordersList.innerHTML = '';
  sentOrders.forEach(o => {
    const p = document.createElement('p');
    p.innerHTML = `<strong>🛒 ${o.product}</strong> | 💵 ${o.price} | 👤 ${o.name} | 📱 ${o.whatsapp} | 📝 ${o.note} | 📅 ${o.date}`;
    ordersList.appendChild(p);
  });
}

function closeOrdersPopup() { document.getElementById('ordersListPopup').style.display = 'none'; }

renderProducts();
updateCartCount();
</script>
</body>
</html>
